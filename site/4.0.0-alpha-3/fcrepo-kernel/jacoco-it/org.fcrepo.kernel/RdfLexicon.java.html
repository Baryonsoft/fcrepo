<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>RdfLexicon.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">fcrepo-kernel</a> &gt; <a href="index.source.html" class="el_package">org.fcrepo.kernel</a> &gt; <span class="el_source">RdfLexicon.java</span></div><h1>RdfLexicon.java</h1><pre class="source lang-java linenums">/**
 * Copyright 2013 DuraSpace, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.fcrepo.kernel;

import static com.google.common.base.Predicates.in;
import static com.google.common.base.Predicates.or;
import static com.google.common.collect.ImmutableSet.of;
import static com.hp.hpl.jena.rdf.model.ResourceFactory.createProperty;
import static com.hp.hpl.jena.rdf.model.ResourceFactory.createResource;

import java.util.Set;

import com.google.common.base.Predicate;
import com.google.common.collect.ImmutableSet;
import com.hp.hpl.jena.rdf.model.Property;
import com.hp.hpl.jena.rdf.model.Resource;

/**
 * A lexicon of the RDF properties that the fcrepo kernel (or close-to-core modules) use
 */
public final class RdfLexicon {

    /**
     * Repository namespace &quot;fcrepo&quot;, used for JCR properties exposed
     * publicly.
     * Was &quot;info:fedora/fedora-system:def/internal#&quot;.
    **/
    public static final String REPOSITORY_NAMESPACE =
            &quot;http://fedora.info/definitions/v4/repository#&quot;;

    /**
     *  The core JCR namespace.
     */
    public static final String JCR_NAMESPACE = &quot;http://www.jcp.org/jcr/1.0&quot;;


    /**
     * REST API namespace &quot;fedora&quot;, used for internal API links and node
     * paths.
     * Was &quot;info:fedora/&quot;.
    **/
    public static final String RESTAPI_NAMESPACE =
            &quot;http://fedora.info/definitions/v4/rest-api#&quot;;

    /**
     * Fedora configuration namespace &quot;fedora-config&quot;, used for user-settable
     * configuration properties.
     **/
    public static final String FEDORA_CONFIG_NAMESPACE =
            &quot;http://fedora.info/definitions/v4/config#&quot;;

    /**
     * REST API namespace &quot;fedora&quot;, used for internal API links and node
     * paths.
     * Was &quot;info:fedora/&quot;.
     **/
    public static final String PREMIS_NAMESPACE =
        &quot;http://www.loc.gov/premis/rdf/v1#&quot;;

    /**
     * The namespaces that the repository manages internally.
     */
<span class="fc" id="L76">    public static final Set&lt;String&gt; managedNamespaces = of(RESTAPI_NAMESPACE,</span>
            REPOSITORY_NAMESPACE, JCR_NAMESPACE);

    /**
     * Is this namespace one that the repository manages?
     */
<span class="fc" id="L82">    public static final Predicate&lt;String&gt; isManagedNamespace =</span>
        in(managedNamespaces);

    /**
     * Relations (RELS-EXT) namespace &quot;fedorarelsext&quot;, used for linking
     * between Fedora objects.
     * Was &quot;info:fedora/fedora-system:def/relations-external#&quot;.
    **/
    public static final String RELATIONS_NAMESPACE =
            &quot;http://fedora.info/definitions/v4/rels-ext#&quot;;

    // MEMBERSHIP
<span class="fc" id="L94">    public static final Property HAS_MEMBER_OF_RESULT =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;hasMember&quot;);
<span class="fc" id="L96">    public static final Property HAS_PARENT =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;hasParent&quot;);
<span class="fc" id="L98">    public static final Property HAS_CHILD =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;hasChild&quot;);
<span class="fc" id="L100">    public static final Property HAS_CHILD_COUNT =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;numberOfChildren&quot;);

<span class="fc" id="L103">    public static final Set&lt;Property&gt; membershipProperties = of(</span>
            HAS_MEMBER_OF_RESULT, HAS_PARENT, HAS_CHILD, HAS_CHILD_COUNT);

    // FIXITY

<span class="fc" id="L108">    public static final Resource FIXITY_TYPE = createResource(PREMIS_NAMESPACE + &quot;Fixity&quot;);</span>
<span class="fc" id="L109">    public static final Property HAS_MESSAGE_DIGEST =</span>
        createProperty(PREMIS_NAMESPACE + &quot;hasMessageDigest&quot;);
<span class="fc" id="L111">    public static final Property HAS_SIZE =</span>
        createProperty(PREMIS_NAMESPACE + &quot;hasSize&quot;);
<span class="fc" id="L113">    public static final Property HAS_FIXITY_RESULT =</span>
        createProperty(PREMIS_NAMESPACE + &quot;hasFixity&quot;);

<span class="fc" id="L116">    public static final Property HAS_FIXITY_STATE =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;status&quot;);

<span class="fc" id="L119">    public static final Property HAS_FIXITY_CHECK_COUNT =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;numFixityChecks&quot;);
<span class="fc" id="L121">    public static final Property HAS_FIXITY_ERROR_COUNT =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;numFixityErrors&quot;);
<span class="fc" id="L123">    public static final Property HAS_FIXITY_REPAIRED_COUNT =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;numFixityRepaired&quot;);

<span class="fc" id="L126">    public static final Set&lt;Property&gt; fixityProperties = of(</span>
            HAS_FIXITY_RESULT, HAS_MESSAGE_DIGEST, HAS_SIZE, HAS_FIXITY_STATE,
            HAS_FIXITY_CHECK_COUNT, HAS_FIXITY_ERROR_COUNT, HAS_FIXITY_REPAIRED_COUNT);

    // SEARCH
<span class="fc" id="L131">    public static final Property SEARCH_PAGE = createProperty(&quot;http://sindice.com/vocab/search#Page&quot;);</span>
<span class="fc" id="L132">    public static final Property SEARCH_HAS_TOTAL_RESULTS =</span>
            createProperty(&quot;http://sindice.com/vocab/search#totalResults&quot;);
<span class="fc" id="L134">    public static final Property SEARCH_ITEMS_PER_PAGE =</span>
            createProperty(&quot;http://sindice.com/vocab/search#itemsPerPage&quot;);
<span class="fc" id="L136">    public static final Property SEARCH_OFFSET =</span>
            createProperty(&quot;http://sindice.com/vocab/search#startIndex&quot;);
<span class="fc" id="L138">    public static final Property SEARCH_TERMS =</span>
            createProperty(&quot;http://sindice.com/vocab/search#searchTerms&quot;);
<span class="fc" id="L140">    public static final Property SEARCH_HAS_MORE =</span>
            createProperty(RESTAPI_NAMESPACE + &quot;hasMoreResults&quot;);

<span class="fc" id="L143">    public static final Set&lt;Property&gt; searchProperties = of(SEARCH_PAGE,</span>
            SEARCH_HAS_TOTAL_RESULTS, SEARCH_ITEMS_PER_PAGE, SEARCH_OFFSET,
            SEARCH_OFFSET, SEARCH_TERMS, SEARCH_HAS_MORE);

    // Linked Data Platform
    public static final String LDP_NAMESPACE = &quot;http://www.w3.org/ns/ldp#&quot;;
<span class="fc" id="L149">    public static final Property PAGE =</span>
        createProperty(LDP_NAMESPACE + &quot;Page&quot;);
<span class="fc" id="L151">    public static final Property PAGE_OF =</span>
        createProperty(LDP_NAMESPACE + &quot;pageOf&quot;);
<span class="fc" id="L153">    public static final Property FIRST_PAGE =</span>
        createProperty(LDP_NAMESPACE + &quot;firstPage&quot;);
<span class="fc" id="L155">    public static final Property NEXT_PAGE =</span>
            createProperty(LDP_NAMESPACE + &quot;nextPage&quot;);
<span class="fc" id="L157">    public static final Property MEMBERS_INLINED =</span>
            createProperty(LDP_NAMESPACE + &quot;membersInlined&quot;);
<span class="fc" id="L159">    public static final Property CONTAINER =</span>
            createProperty(LDP_NAMESPACE + &quot;Container&quot;);
<span class="fc" id="L161">    public static final Property MEMBERSHIP_SUBJECT =</span>
            createProperty(LDP_NAMESPACE + &quot;membershipSubject&quot;);
<span class="fc" id="L163">    public static final Property MEMBERSHIP_PREDICATE =</span>
            createProperty(LDP_NAMESPACE + &quot;membershipPredicate&quot;);
<span class="fc" id="L165">    public static final Property MEMBERSHIP_OBJECT =</span>
            createProperty(LDP_NAMESPACE + &quot;membershipObject&quot;);
<span class="fc" id="L167">    public static final Property MEMBER_SUBJECT =</span>
            createProperty(LDP_NAMESPACE + &quot;MemberSubject&quot;);
<span class="fc" id="L169">    public static final Property INLINED_RESOURCE =</span>
        createProperty(LDP_NAMESPACE + &quot;inlinedResource&quot;);

<span class="fc" id="L172">    public static final Set&lt;Property&gt; ldpProperties = of(PAGE, PAGE_OF,</span>
            FIRST_PAGE, NEXT_PAGE, MEMBERS_INLINED, CONTAINER,
            MEMBERSHIP_SUBJECT, MEMBERSHIP_PREDICATE, MEMBERSHIP_OBJECT,
            MEMBER_SUBJECT, INLINED_RESOURCE);

    // REPOSITORY INFORMATION
<span class="fc" id="L178">    public static final Property HAS_OBJECT_COUNT =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;objectCount&quot;);
<span class="fc" id="L180">    public static final Property HAS_OBJECT_SIZE =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;objectSize&quot;);
<span class="fc" id="L182">    public static final Property HAS_TRANSACTION_SERVICE =</span>
            createProperty(RESTAPI_NAMESPACE + &quot;hasTransactionProvider&quot;);
<span class="fc" id="L184">    public static final Property HAS_NAMESPACE_SERVICE =</span>
            createProperty(RESTAPI_NAMESPACE + &quot;hasNamespaces&quot;);
<span class="fc" id="L186">    public static final Property HAS_WORKSPACE_SERVICE =</span>
            createProperty(RESTAPI_NAMESPACE + &quot;hasWorkspaces&quot;);
<span class="fc" id="L188">    public static final Property HAS_ACCESS_ROLES_SERVICE =</span>
            createProperty(RESTAPI_NAMESPACE + &quot;hasAccessRoles&quot;);
<span class="fc" id="L190">    public static final Property HAS_SEARCH_SERVICE =</span>
            createProperty(&quot;http://www.whatwg.org/specs/web-apps/current-work/&quot;
                                   + &quot;#link-type-search&quot;);
<span class="fc" id="L193">    public static final Property HAS_SITEMAP =</span>
            createProperty(&quot;http://microformats.org/wiki/rel-sitemap&quot;);

<span class="fc" id="L196">    public static final Set&lt;Property&gt; repositoryProperties = of(</span>
            HAS_OBJECT_COUNT, HAS_OBJECT_SIZE, HAS_TRANSACTION_SERVICE,
            HAS_NAMESPACE_SERVICE, HAS_WORKSPACE_SERVICE, HAS_SEARCH_SERVICE,
            HAS_SITEMAP);

    // NAMESPACES
<span class="fc" id="L202">    public static final Property HAS_NAMESPACE_PREFIX =</span>
            createProperty(&quot;http://purl.org/vocab/vann/preferredNamespacePrefix&quot;);
<span class="fc" id="L204">    public static final Property HAS_NAMESPACE_URI =</span>
            createProperty(&quot;http://purl.org/vocab/vann/preferredNamespaceUri&quot;);
<span class="fc" id="L206">    public static final Property VOAF_VOCABULARY = createProperty(&quot;http://purl.org/vocommons/voaf#Vocabulary&quot;);</span>

<span class="fc" id="L208">    public static final Set&lt;Property&gt; namespaceProperties = of(</span>
            HAS_NAMESPACE_PREFIX, HAS_NAMESPACE_URI, VOAF_VOCABULARY);

    // OTHER SERVICES
<span class="fc" id="L212">    public static final Property HAS_SERIALIZATION =</span>
            createProperty(RESTAPI_NAMESPACE + &quot;exportsAs&quot;);
<span class="fc" id="L214">    public static final Property HAS_VERSION_HISTORY =</span>
            createProperty(RESTAPI_NAMESPACE + &quot;hasVersions&quot;);
<span class="fc" id="L216">    public static final Property HAS_FIXITY_SERVICE =</span>
            createProperty(RESTAPI_NAMESPACE + &quot;hasFixityService&quot;);
<span class="fc" id="L218">    public static final Property HAS_FEED =</span>
            createProperty(
                    &quot;http://www.whatwg.org/specs/web-apps/current-work/#&quot;,
                    &quot;feed0&quot;);
<span class="fc" id="L222">    public static final Property HAS_SUBSCRIPTION_SERVICE =</span>
            createProperty(&quot;http://microformats.org/wiki/rel-subscription&quot;);
<span class="fc" id="L224">    public static final Property NOT_IMPLEMENTED =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;notImplemented&quot;);
<span class="fc" id="L226">    public static final Property HAS_SPARQL_ENDPOINT =</span>
        createProperty(RESTAPI_NAMESPACE + &quot;sparql&quot;);

<span class="fc" id="L229">    public static final Set&lt;Property&gt; otherServiceProperties = of(</span>
            HAS_SERIALIZATION, HAS_VERSION_HISTORY, HAS_FIXITY_SERVICE,
            HAS_FEED, HAS_SUBSCRIPTION_SERVICE, NOT_IMPLEMENTED);


    // CONTENT
<span class="fc" id="L235">    public static final Property HAS_CONTENT =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;hasContent&quot;);
<span class="fc" id="L237">    public static final Property IS_CONTENT_OF =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;isContentOf&quot;);
<span class="fc" id="L239">    public static final Resource CONTENT_LOCATION_TYPE =</span>
            createResource(PREMIS_NAMESPACE + &quot;ContentLocation&quot;);
<span class="fc" id="L241">    public static final Property HAS_CONTENT_LOCATION =</span>
            createProperty(PREMIS_NAMESPACE + &quot;hasContentLocation&quot;);
<span class="fc" id="L243">    public static final Property HAS_CONTENT_LOCATION_VALUE =</span>
        createProperty(PREMIS_NAMESPACE + &quot;hasContentLocationValue&quot;);
<span class="fc" id="L245">    public static final Property HAS_MIME_TYPE =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;mimeType&quot;);
<span class="fc" id="L247">    public static final Property HAS_ORIGINAL_NAME =</span>
            createProperty(PREMIS_NAMESPACE + &quot;hasOriginalName&quot;);

<span class="fc" id="L250">    public static final Set&lt;Property&gt; contentProperties = of(HAS_CONTENT,</span>
            IS_CONTENT_OF, HAS_CONTENT_LOCATION, HAS_CONTENT_LOCATION_VALUE,
            HAS_MIME_TYPE, HAS_ORIGINAL_NAME, HAS_SIZE);


    // VERSIONING
<span class="fc" id="L256">    public static final Property HAS_VERSION =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;hasVersion&quot;);
<span class="fc" id="L258">    public static final Property HAS_VERSION_LABEL =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;hasVersionLabel&quot;);
<span class="fc" id="L260">    public static final Property VERSIONING_POLICY =</span>
            createProperty(FEDORA_CONFIG_NAMESPACE + &quot;versioningPolicy&quot;);

<span class="fc" id="L263">    public static final Set&lt;Property&gt; versioningProperties = of(HAS_VERSION,</span>
            HAS_VERSION_LABEL);

    // RDF EXTRACTION
<span class="fc" id="L267">    public static final Property COULD_NOT_STORE_PROPERTY =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;couldNotStoreProperty&quot;);

    // IMPORTANT JCR PROPERTIES
<span class="fc" id="L271">    public static final Property HAS_PRIMARY_IDENTIFIER =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;uuid&quot;);
<span class="fc" id="L273">    public static final Property HAS_PRIMARY_TYPE =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;primaryType&quot;);
<span class="fc" id="L275">    public static final Property HAS_NODE_TYPE =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;hasNodeType&quot;);
<span class="fc" id="L277">    public static final Property HAS_MIXIN_TYPE =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;mixinTypes&quot;);
<span class="fc" id="L279">    public static final Property CREATED_DATE =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;created&quot;);
<span class="fc" id="L281">    public static final Property CREATED_BY =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;createdBy&quot;);
<span class="fc" id="L283">    public static final Property LAST_MODIFIED_DATE =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;lastModified&quot;);
<span class="fc" id="L285">    public static final Property LAST_MODIFIED_BY =</span>
            createProperty(REPOSITORY_NAMESPACE + &quot;lastModifiedBy&quot;);

<span class="fc" id="L288">    public static final Set&lt;Property&gt; jcrProperties = of(</span>
            HAS_PRIMARY_IDENTIFIER, HAS_PRIMARY_TYPE, HAS_NODE_TYPE,
            HAS_MIXIN_TYPE, CREATED_DATE, CREATED_BY, LAST_MODIFIED_DATE,
            LAST_MODIFIED_BY);

<span class="fc" id="L293">    public static final Property RDFS_LABEL =</span>
            createProperty(&quot;http://www.w3.org/2000/01/rdf-schema#label&quot;);
<span class="fc" id="L295">    public static final Property DC_TITLE =</span>
            createProperty(&quot;http://purl.org/dc/elements/1.1/title&quot;);

<span class="fc" id="L298">    public static final Resource WORKSPACE_TYPE = createResource(JCR_NAMESPACE + &quot;#Workspace&quot;);</span>
<span class="fc" id="L299">    public static final Property HAS_WORKSPACE = createProperty(REPOSITORY_NAMESPACE + &quot;hasWorkspace&quot;);</span>
<span class="fc" id="L300">    public static final Property HAS_DEFAULT_WORKSPACE = createProperty(REPOSITORY_NAMESPACE + &quot;hasDefaultWorkspace&quot;);</span>

    public static final Set&lt;Property&gt; managedProperties;

    static {
<span class="fc" id="L305">        final ImmutableSet.Builder&lt;Property&gt; b = ImmutableSet.builder();</span>
<span class="fc" id="L306">        b.addAll(membershipProperties).addAll(fixityProperties).addAll(</span>
                searchProperties).addAll(ldpProperties).addAll(
                repositoryProperties).addAll(namespaceProperties).addAll(
                otherServiceProperties).addAll(contentProperties).addAll(
                versioningProperties).addAll(jcrProperties);
<span class="fc" id="L311">        managedProperties = b.build();</span>
    }

<span class="fc" id="L314">    private static Predicate&lt;Property&gt; hasJcrNamespace =</span>
<span class="fc" id="L315">        new Predicate&lt;Property&gt;() {</span>

            @Override
            public boolean apply(final Property p) {
<span class="nc bnc" id="L319" title="All 4 branches missed.">                return !p.isAnon() &amp;&amp; p.getNameSpace().equals(JCR_NAMESPACE);</span>

            }
        };

<span class="fc" id="L324">    private static Predicate&lt;Property&gt; hasFedoraNamespace =</span>
<span class="fc" id="L325">        new Predicate&lt;Property&gt;() {</span>

            @Override
            public boolean apply(final Property p) {
<span class="nc bnc" id="L329" title="All 4 branches missed.">                return !p.isAnon()</span>
                        &amp;&amp; p.getNameSpace().startsWith(REPOSITORY_NAMESPACE);

            }
        };

    /**
     * Detects whether an RDF property is managed by the repository.
     */
    @SuppressWarnings(&quot;unchecked&quot;)
<span class="fc" id="L339">    public static final Predicate&lt;Property&gt; isManagedPredicate = or(</span>
            in(managedProperties), hasJcrNamespace, hasFedoraNamespace);

    /**
     * Detects whether an RDF predicate URI is managed by the repository.
    **/
<span class="fc" id="L345">    public static Predicate&lt;String&gt; isManagedPredicateURI =</span>
<span class="fc" id="L346">        new Predicate&lt;String&gt;() {</span>
            @Override
            public boolean apply(final String uri) {
<span class="nc" id="L349">                return isManagedPredicate.apply( createProperty(uri) );</span>
            }
        };

<span class="nc" id="L353">    private RdfLexicon() {</span>

<span class="nc" id="L355">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.4.201312101107</span></div></body></html>